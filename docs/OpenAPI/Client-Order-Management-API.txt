openapi: 3.0.0
info:
  title: Order Management API (Client)
  version: 1.0.0
  description: >
    Provides endpoints for an authenticated client to view their own order
    history. This is a subset of the main Pharmacy Management System API.

    Authentication is handled via bearer tokens issued by Laravel Sanctum.
servers:
  - url: 'http://localhost:8000/api'
    description: Local Development Server
paths:
  /my-orders:
    get:
      summary: Get my orders (Client)
      tags:
        - Orders
      security:
        - bearerAuth: []
      description: >-
        Client-only endpoint that returns a list of orders belonging to the
        authenticated user.
      responses:
        '200':
          description: A list of the user's orders.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Order'
        '401':
          description: Unauthenticated.
        '403':
          description: Forbidden.
  '/my-orders/{id}':
    get:
      summary: Get a single one of my orders (Client)
      tags:
        - Orders
      security:
        - bearerAuth: []
      description: >-
        Client-only endpoint that returns a single order, if and only if it
        belongs to the authenticated user.
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: The ID of the order to retrieve.
      responses:
        '200':
          description: The detailed order object.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '401':
          description: Unauthenticated.
        '403':
          description: Forbidden. The user does not own this order.
        '404':
          description: Order not found.
components:
  schemas:
    Order:
      type: object
      properties:
        id:
          type: integer
          example: 987
        client_id:
          type: integer
          example: 1
        prescription_id:
          type: integer
          nullable: true
          example: 54321
        total_amount:
          type: number
          format: float
          example: 47.97
        status:
          type: string
          enum:
            - in_preparation
            - ready_for_delivery
            - completed
            - cancelled
            - failed_delivery
          example: in_preparation
        assigned_delivery_user_id:
          type: integer
          nullable: true
          example: 25
        cancellation_reason:
          type: string
          nullable: true
        items:
          type: array
          items:
            $ref: '#/components/schemas/OrderItem'
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    OrderItem:
      type: object
      properties:
        id:
          type: integer
        order_id:
          type: integer
        medication_id:
          type: integer
        quantity:
          type: integer
        unit_price:
          type: number
          format: float
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT