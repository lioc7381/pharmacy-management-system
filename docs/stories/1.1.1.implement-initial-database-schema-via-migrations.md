---
Status: Approved
Epic: 1
Story: 1.1.1
Title: Implement Initial Database Schema via Migrations
---

### Story
As a Developer,
I want to implement the initial database schema for the existing Laravel backend,
so that the database is ready for feature development.

### Acceptance Criteria
1.  The existing `0001_01_01_000000_create_users_table.php` migration is modified, and six new migration files are created in `backend/database/migrations/`. Together, these migrations must establish the `users`, `medications`, `prescriptions`, `orders`, `order_items`, `advice_requests`, and `notifications` tables, accurately reflecting the schema in [`docs/architecture/database-schema.md`](../../docs/architecture/database-schema.md).
2.  The `php artisan migrate` command executes successfully against the pre-configured SQLite database, as mandated by project constraint [NFR2](../../docs/prd/requirements.md#non-functional) and documented in [`technical-assumptions.md`](../../docs/prd/technical-assumptions.md). The command must complete without errors, creating all required tables and indexes.

### Tasks / Subtasks
1.  **Modify `users` Table Migration** (AC: #1)
    *   [ ] Edit the existing `backend/database/migrations/0001_01_01_000000_create_users_table.php` file.
    *   [ ] Alter the `users` table schema to match the definition in [`docs/architecture/database-schema.md`](../../docs/architecture/database-schema.md). This includes adding the `phone_number`, `address`, `role`, and `status` columns.
    *   [ ] Remove columns not specified in the schema (e.g., `email_verified_at`, `remember_token`).
    *   [ ] Remove the creation of the `password_reset_tokens` and `sessions` tables from this file to ensure migrations are responsible for a single logical change.
2.  **Create New Migration Files** (AC: #1)
    *   [ ] Create a new migration for the `medications` table.
    *   [ ] Create a new migration for the `prescriptions` table.
    *   [ ] Create a new migration for the `orders` table.
    *   [ ] Create a new migration for the `order_items` table.
    *   [ ] Create a new migration for the `advice_requests` table.
    *   [ ] Create a new migration for the `notifications` table.
3.  **Execute and Verify Migrations** (AC: #2)
    *   [ ] Run `php artisan migrate` to apply the schema to the SQLite database.
    *   [ ] Confirm that the command completes without errors and the expected tables and indexes are created.

### Dev Notes
**CRITICAL:** This story establishes the database foundation. All table and column names must strictly adhere to the architecture documents to ensure consistency with the [`docs/architecture/data-models.md`](../../docs/architecture/data-models.md).

*   **Handling Existing Migrations:** A default `users` table migration (`0001_01_01_000000_create_users_table.php`) already exists from the initial Laravel installation. This file must be **modified**, not replaced. Other default migrations provided by Laravel (e.g., for `cache`, `jobs`, `personal_access_tokens`) can be ignored for this story, as they are framework-level concerns and not part of the core application domain schema.
*   **Source of Truth:** The complete database schema (DDL) to be used for the migrations is defined in [`docs/architecture/database-schema.md`](../../docs/architecture/database-schema.md). This document includes SQLite-specific implementations, such as using `CHECK` constraints and specific `ON DELETE` clauses for foreign keys, which must be correctly translated into the Laravel migration files.
*   **Laravel Conventions:** While the schema is defined in raw SQL, the implementation should use Laravel's Schema Builder. For example, `TEXT NOT NULL CHECK(role IN ('client', ...))` should be implemented using `$table->string('role')->default('client');`. Foreign keys should be defined using methods like `foreignId('client_id')->constrained('users')->onDelete('restrict')`.

#### Testing
*   As per [`technical-assumptions.md`](../../docs/prd/technical-assumptions.md), the project follows a unit and integration testing strategy.
*   For this story, testing is primarily a verification process. The primary test is the successful execution of `php artisan migrate` as specified in AC #2.
*   Manual verification of the generated `database.sqlite` file schema against [`docs/architecture/database-schema.md`](../../docs/architecture/database-schema.md) is recommended to confirm all constraints and indexes are created correctly. No specific unit or feature test files are required for this story.

### Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |

### Dev Agent Record
This section is populated by the development agent during implementation.

#### Agent Model Used
_TBD_

#### Debug Log References
_TBD_

#### Completion Notes List
_TBD_

#### File List
_TBD_

### QA Results
_TBD_